"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};module.exports=function(){function e(e,r){var o={current:"",temp:""},u={current:null,temp:null},c=function(){var o=e(n()).trim(),u=[];"object"===("undefined"==typeof r?"undefined":_typeof(r))&&Object.keys(r).forEach(function(e){if(-1===l.indexOf(e))return console.error(e+" is not a valid event");if(t(r[e])){if(!r[e].length)return console.error("empty array for "+e+" event");var n=r[e].shift(),o=r[e].length?","+r[e].map(function(e){return"string"==typeof e?"'"+e+"'":e}).join(","):"";u.push("on"+e+"=\"(function(){temps.emit('"+n+"'"+o+')})()" ')}else"string"==typeof r[e]?u.push("on"+e+"=\"(function(){temps.emit('"+r[e]+"')})()\" "):console.error("could not parse value for "+e)});var c=u.join("").trim();if(c.length){var a=o.match(/^<\w+(-\w+)?(\s|>)/);if(!a||!a.length)return console.error("no match for "+o),o;var i=a[0],f=i.slice(0,-1),s=i.slice(-1);return o.replace(i,f+" "+c+" "+s)}return o};return{render:function(){if(o.temp=c(),u.current&&o.temp===o.current)return u.current;var e=document.createElement("div");e.innerHTML=o.temp,u.temp=e.firstChild;var t=o.temp;return u.temp.toString=function(){return t},u.current||(u.current=u.temp),u.current&&u.current.parentNode&&u.current.parentNode.replaceChild(u.temp,u.current),o.current=o.temp,u.current=u.temp,o.temp=u.temp=null,u.current},toString:function(){return c()},attachStateEvent:function(){for(var e=this,t=arguments.length,r=Array(t),n=0;t>n;n++)r[n]=arguments[n];r.forEach(function(t){"undefined"==typeof f[t]&&(f[t]=[]),f[t].push(e)})}}}var t=function(e){return"object"===("undefined"==typeof e?"undefined":_typeof(e))&&(Array.isArray&&Array.isArray(e)||e.constructor===Array||e instanceof Array)},r=[],n=function(){return r[r.length-1]},o=function m(e){r.length>1&&r.pop(),"number"==typeof e&&e>1?m(e-1):p("STATE_REVERTED")},u=function(){r.splice(1),p("STATE_RESET")},c=function(e){return r[0]=e},a=function(e){return r.push(e)},i={},f={},s=function(e,r){t(i[e])||(i[e]=[]),i[e].push(r)},p=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),o=1;t>o;o++)r[o-1]=arguments[o];i[e]&&("STATE_RESET"===e||"STATE_REVERTED"===e?i[e].forEach(function(e){return e.apply(void 0,[n()].concat(r))}):!function(){var t=Object.assign({},n());i[e].forEach(function(e){return e.apply(void 0,[t].concat(r))}),a(t)}()),f[e]&&f[e].forEach(function(e){e.render()})},l=["abort","autocomplete","autocompleteerror","beforecopy","beforecut","beforepaste","blur","cancel","canplay","canplaythrough","change","click","close","contextmenu","copy","cuechange","cut","dblclick","drag","dragend","dragenter","dragleave","dragover","dragstart","drop","durationchange","emptied","ended","error","focus","input","invalid","keydown","keypress","keyup","load","loadeddata","loadedmetadata","loadstart","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","mousewheel","paste","pause","play","playing","progress","ratechange","reset","resize","scroll","search","seeked","seeking","select","selectstart","show","stalled","submit","suspend","timeupdate","toggle","volumechange","waiting"];return e.getState=function(){return n()},e.resetState=function(){return u()},e.setInitialState=function(e){return c(e)},e.stateHistory=function(){return r.map(function(e){return e})},e.revertState=function(e){return o(e)},e.on=function(e,t){return s(e,t)},e.emit=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;t>n;n++)r[n-1]=arguments[n];return p.apply(void 0,[e].concat(r))},e}();