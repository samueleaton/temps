"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};module.exports=function(){function t(t){var n=[];return"object"===("undefined"==typeof t?"undefined":_typeof(t))&&Object.keys(t).forEach(function(e){if(r(t[e])){if(!t[e].length)return console.error("empty array for "+e+" event");var o=t[e].shift(),u=t[e].length?","+t[e].map(function(t){return"string"==typeof t?"'"+t+"'":"object"===("undefined"==typeof t?"undefined":_typeof(t))?JSON.stringify(t).replace(/"/g,"&quot;"):t}).join(","):"";n.push("on"+e+"=\"(function(){temps.emit('"+o+"'"+u+')})()" ')}else"string"==typeof t[e]?n.push("on"+e+"=\"(function(){temps.emit('"+t[e]+"')})()\" "):console.error("could not parse value for "+e)}),n}function n(n,e){var r=t(e),o=r.join("").trim();if(o.length){var u=n.match(/^<\w+(-\w+)?(\s|>)/);if(!u||!u.length)return console.error("tag parse err: "+n),n;var c=u[0],i=c.slice(0,-1),f=c.slice(-1);return n.replace(c,i+" "+o+" "+f)}return n}function e(t,e){var r={current:"",temp:""},o={current:null,temp:null},u=function(){return n(t(f()).trim(),e)};return{render:function(){if(r.temp=u(),o.current&&r.temp===r.current)return o.current;var t=document.createElement("div");t.innerHTML=r.temp,o.temp=t.firstChild;var n=r.temp;return o.temp.toString=function(){return n},o.current||(o.current=o.temp),o.current&&o.current.parentNode&&o.current.parentNode.replaceChild(o.temp,o.current),r.current=r.temp,o.current=o.temp,r.temp=o.temp=null,o.current},toString:function(){return u()},attachStateEvent:function(){for(var t=this,n=arguments.length,e=Array(n),r=0;n>r;r++)e[r]=arguments[r];e.forEach(function(n){"undefined"==typeof g[n]&&(g[n]=[]),g[n].push(t)})}}}var r=function(t){return"object"===("undefined"==typeof t?"undefined":_typeof(t))&&(Array.isArray&&Array.isArray(t)||t.constructor===Array||t instanceof Array)},o=[],u="STATE_RESET",c="STATE_REVERTED",i="STATE_MODIFIED",f=function(){return o[o.length-1]},a=function(){o.splice(1),v(u)},p=function S(t){o.length>1&&o.pop(),"number"==typeof t&&t>1?S(t-1):v(c)},s=function(t){console.log("modifying state: ",f());var n=Object.assign({},f());t(n),y(n),console.log("modified state: ",f()),v(i)},l=function(){return o.length<=2?o[1]:o[o.length-2]},m=function(t){return o[0]=t},y=function(t){return o.push(t)},d={},g={},h=function(t,n){r(d[t])||(d[t]=[]),d[t].push(n)},v=function(t){for(var n=arguments.length,e=Array(n>1?n-1:0),r=1;n>r;r++)e[r-1]=arguments[r];d[t]&&(t===u||t===c||t===i?(d[t].forEach(function(t){return t.apply(void 0,[f()].concat(e))}),console.log("STATE_MODIFIED: ",d)):!function(){var n=Object.assign({},f());d[t].forEach(function(t){return t.apply(void 0,[n].concat(e))}),y(n)}()),g[t]&&g[t].forEach(function(t){t.render()})};return e.currentState=function(){return Object.assign({},f())},e.previousState=function(){return Object.assign({},l())},e.resetState=a,e.setInitialState=m,e.stateHistory=function(){return o.map(function(t){return t})},e.revertState=p,e.on=h,e.emit=v,e.modifyState=function(t){return s(t)},e}();